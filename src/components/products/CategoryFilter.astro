---
// src/components/products/CategoryFilter.astro
import { getAllCategories, getProductCountByCategory } from '../../lib/products';

interface Props {
  selectedCategory?: string;
  baseUrl?: string;
}

const { selectedCategory = 'todos', baseUrl = '/productos' } = Astro.props;
const categories = getAllCategories();

const formatCategoryName = (category: string): string => {
  if (category === 'todos') return 'Todos los productos';
  return category.charAt(0).toUpperCase() + category.slice(1).replace('-', ' ');
};
---

<div class="space-y-4">
  <h3 class="text-lg font-medium text-gray-900">Categor√≠as</h3>
  <ul class="space-y-2">
    {categories.map((category) => {
      const isSelected = selectedCategory === category;
      const count = getProductCountByCategory(category);
      const categoryName = formatCategoryName(category);
      const href = `${baseUrl}${category === 'todos' ? '' : `?categoria=${category}`}`;
      
      return (
        <li>
          <a
            href={href}
            class={`flex items-center justify-between px-3 py-2 rounded-md ${
              isSelected
                ? 'bg-blue-50 text-blue-700 font-medium'
                : 'text-gray-600 hover:bg-gray-50'
            }`}
            aria-current={isSelected ? 'page' : undefined}
          >
            <span>{categoryName}</span>
            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800">
              {count}
            </span>
          </a>
        </li>
      );
    })}
  </ul>
</div>

<style>
  a {
    transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out;
  }
</style>
